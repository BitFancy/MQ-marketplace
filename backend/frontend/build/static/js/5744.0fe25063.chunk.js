"use strict";(self.webpackChunknft_market=self.webpackChunknft_market||[]).push([[5744],{63814:(e,a,n)=>{n.d(a,{a:()=>l});var t=n(79425),s=n(65043),l=()=>{let{authCoreModal:e}=(0,t.ba)(),a=(0,s.useMemo)((()=>e.rootModalContainer),[e]),n=(0,s.useCallback)((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var t;let s=document.createElement("div");s.className="ant-message-notice";let l=document.createElement("div");l.className="ant-message-notice-content";let r=document.createElement("div");r.className="ant-message-custom-content";let i=document.createElement("span");i.setAttribute("role","img"),i.setAttribute("aria-label","check-circle"),i.className="anticon anticon-check-circle";let c=document.createElement("svg");"success"===e?(r.className+=" ant-message-success",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"></path></svg>'):"error"===e?(r.className+=" ant-message-error",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="close-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"></path></svg>'):"info"===e?(r.className+=" ant-message-info",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="info-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"></path></svg>'):"warning"===e&&(r.className+=" ant-message-warning",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="exclamation-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"></path></svg>');let o=document.createElement("span");return o.textContent=n,i.appendChild(c),r.appendChild(i),r.appendChild(o),l.appendChild(r),s.appendChild(l),null==(t=null==a?void 0:a.querySelector(".ant-message"))||t.appendChild(s),s}),[a]),l=(0,s.useCallback)((e=>{let t=n("error",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(t)}),2e3)}),[n]),r=(0,s.useCallback)((e=>{let t=n("info",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(t)}),2e3)}),[n]),i=(0,s.useCallback)((e=>{let t=n("success",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(t)}),2e3)}),[n]),c=(0,s.useCallback)((e=>{let t=n("warning",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(t)}),2e3)}),[n]);return(0,s.useEffect)((()=>{if(a){if(a.querySelector(".ant-message"))return;let e=document.createElement("div");e.className="ant-message",a.appendChild(e)}}),[a]),{error:l,info:r,success:i,warning:c}}},95744:(e,a,n)=>{n.r(a),n.d(a,{default:()=>E});var t=n(76904),s=n(49939),l=n(63814),r=n(11606),i=n(79425),c=n(35478),o=n(40173),m=n(68366),d=n(24539),u=n(89421),g=n(40462),v=n(65043),h=n(61476),p=n(2599),f={async findAssociatedTokenAddress(e,a){let{TOKEN_PROGRAM_ID:t}=await Promise.all([n.e(945),n.e(3987)]).then(n.bind(n,23987)),{PublicKey:s}=await n.e(945).then(n.bind(n,90945));return s.findProgramAddressSync([new s(e).toBuffer(),t.toBuffer(),new s(a).toBuffer()],new s("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))[0]}};var E=function(e){let{method:a,param:n,chainId:E}=e,{t:C}=(0,p.Bd)(),N=(0,i.da)(),{setPaymentVerify:y,userInfo:w,setPaymentPassword:_}=(0,i.ea)(),{events:S}=(0,i.ga)(),{modalOptions:k}=(0,i.fa)(),{authCoreModal:T}=(0,i.ba)(),{errorHandle:A}=(0,s.a)(),[b,z]=(0,v.useState)(!1),M=(0,l.a)(),[P,L]=(0,v.useState)(),[I,q]=(0,v.useState)(),[B,O]=(0,v.useState)(),[Z,x]=(0,v.useState)(""),[Q,F]=(0,v.useState)(""),{hasSetPaymentPassword:G,showSetPaymentPasswordOrConfirm:R}=(0,t.b)(),U=(0,v.useMemo)((()=>({id:E||o.pQ.solana.chainId,name:"Solana"})),[]),D=(0,v.useMemo)((()=>{let e=o.pQ.solana.selectedAddress;return(0,i.z)(e)}),[]);(0,v.useEffect)((()=>{(0,o.P9)().catch((e=>{})),(0,o.O)()&&N("account/master-password/verify")}),[N]);let H=(e,a)=>{S.emit("signResponse",{result:e,error:a})};async function K(e,a){if(!a)return[];let n=await Promise.all(a.map(e));return a.filter(((e,a)=>n[a]))}let V=async()=>{var e,n;!a||((0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK}),null!=(e=null==w?void 0:w.security_account)&&e.has_set_payment_password?y({visible:!0,onVerifyCompleted:W}):a===o.zZ.signAndSendTransaction||a===o.zZ.signTransaction||a===o.zZ.signAllTransactions||3===(null==(n=null==k?void 0:k.promptSettingConfig)?void 0:n.promptPaymentPasswordSettingWhenSign)?R(W):W())},W=async()=>{var e;if(!a)return;let t;z(!0);try{if(a===o.zZ.signMessage)t=await o.pQ.solana.signMessage(n);else if(a===o.zZ.signAndSendTransaction)t=await o.pQ.solana.signAndSendTransaction(n,U.id);else if(a===o.zZ.signTransaction)t=await o.pQ.solana.signTransaction(n,U.id);else{if(a!==o.zZ.signAllTransactions)throw new Error("Unknown method");t=await o.pQ.solana.signAllTransactions(n,U.id)}(0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK_SUCCESS})}catch(s){(0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK_FAILURE}),50103!==(null==s?void 0:s.error_code)||null!=(e=null==w?void 0:w.security_account)&&e.has_set_payment_password?"Local Key not found"===(null==s?void 0:s.message)||"Master password decryption error"===(null==s?void 0:s.message)?N("account/master-password/verify"):A(s):(0,o.P9)().then((()=>{V()})).catch((e=>{var a;z(!1),M.error(null!=(a=e.message)?a:"Sign Error")}))}finally{z(!1)}t&&H(t)};(0,v.useEffect)((()=>{if(a===o.zZ.signMessage)x(C("sign.signature_message")),F(C("sign.signature_title"));else if(a===o.zZ.signAndSendTransaction){x(C("sign.send_transaction")),F(C("sign.approve_and").format((0,i.s)(U)));let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});j([g.encode(e)])}else if(a===o.zZ.signTransaction){x(C("sign.sign_transaction")),F(C("sign.sign_but"));let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});j([g.encode(e)])}else{if(a!==o.zZ.signAllTransactions)throw new Error("Unknown method");{x(C("sign.sign_transaction")),F(C("sign.sign_but"));let e=n.map((e=>g.encode(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))));j(e)}}}),[n]),(0,v.useEffect)((()=>{o.pQ.solana.connect()}),[]);let j=e=>{o.pQ.solana.request({chainId:U.id,method:o.iP.enhancedDeserializeTransaction,params:e}).then((e=>{var a,n;L(e),K((async e=>{let a=await f.findAssociatedTokenAddress(o.pQ.solana.selectedAddress,e.mint);return e.associatedTokenAddress===a.toBase58()}),null==(a=null==e?void 0:e.estimatedChanges)?void 0:a.nfts).then((e=>{q(e)})),K((async e=>{let a=await f.findAssociatedTokenAddress(o.pQ.solana.selectedAddress,e.mint);return e.associatedTokenAddress===a.toBase58()}),null==(n=null==e?void 0:e.estimatedChanges)?void 0:n.tokens).then((e=>{O(e)}))})).catch((a=>{var n;m.A.error({title:null!=(n=a.message)?n:"Deserialize Transaction Error",okCancel:!0,cancelText:C("common.cancel"),okText:C("common.retry"),wrapClassName:"auth-core-modal-error",getContainer:()=>T.rootBody,onOk:()=>{j(e)}})}))};return v.createElement("div",{className:"info-sign"},v.createElement("style",null,t.c),!G&&v.createElement("div",{className:"has-payment-password"},v.createElement("div",{className:"has-payment-password-icon"}),v.createElement("div",{className:"has-payment-password-tip"},C("account.waring_tip1")),v.createElement("div",{className:"has-payment-password-set",onClick:_},C("account.set"))),v.createElement("div",{className:"scroll-part"+(G?"":" no-password-tip")},v.createElement(t.d,{userInfo:w,transactionInfo:P}),v.createElement("div",{className:"info-request"},Z),v.createElement("div",{className:"info-title"},v.createElement("img",{src:(0,i.u)(U),alt:""}),(0,i.s)(U)),v.createElement(h,{text:o.pQ.solana.selectedAddress,onCopy:()=>M.success(C("new.copied_to"))},v.createElement("div",{className:"info-address"},D,v.createElement("div",{className:"copy-icon"},v.createElement(t.a,null)))),v.createElement("div",{className:"info-des"},Q),v.createElement("div",{className:"apart-line"}),a===o.zZ.signMessage&&(()=>{let e=(new TextDecoder).decode(n);return v.createElement("div",{className:"sign-message"},v.createElement("div",{className:"message"+(G?"":" no-password-tip")},v.createElement("div",{className:"pre-wrap personal-message"},e)))})(),a!==o.zZ.signMessage&&(()=>{var e;return v.createElement(d.A,{defaultActiveKey:"1",items:[{label:C("sign.details"),key:"1",children:v.createElement(v.Fragment,null,v.createElement("div",{className:"balance-change"},v.createElement("div",{className:"title"},C("sign.estimated_balance_change")),v.createElement("div",{className:"change-body"},null==(e=null==P?void 0:P.estimatedChanges)?void 0:e.sols.filter((e=>{var a,n;return e.address===(null==(n=null==(a=o.pQ)?void 0:a.solana)?void 0:n.selectedAddress)})).map(((e,a)=>v.createElement("div",{className:"change-title",key:"sol-change-".concat(a)},"SOL",v.createElement("div",{className:"change-val",style:e.lamportsChange<0?{color:"#ea4335"}:{}},e.lamportsChange<0?"":"+",(0,i.F)(e.lamportsChange,9))))),null==I?void 0:I.map(((e,a)=>v.createElement("div",{className:"change-title",key:"nft-change-".concat(a)},e.name?e.name:"Unknown NFT",v.createElement("div",{className:"change-val",style:e.amountChange<0?{color:"#ea4335"}:{}},e.amountChange<0?"":"+",e.amountChange)))),null==B?void 0:B.map(((e,a)=>v.createElement("div",{className:"change-title",key:"token-change-".concat(a)},e.name?e.name:"Unknown Token",v.createElement("div",{className:"change-val",style:e.amountChange<0?{color:"#ea4335"}:{}},e.amountChange<0?"":"+",(0,i.F)(e.amountChange,e.decimals))))))),v.createElement("div",{className:"net-fee solana"},v.createElement("div",{className:"title"},C("sign.network_fee"),P&&v.createElement("div",{className:"fee-val"},(0,i.F)(P.estimatedLamportsFee,9)," SOL"))))},{label:C("sign.data"),key:"2",children:v.createElement("div",null,null==P?void 0:P.instructions.map(((e,a)=>v.createElement("div",{className:"inner-instruction",key:"instruction-".concat(a)},v.createElement("div",{className:"inner-content"},v.createElement("div",{className:"content-item"},v.createElement("div",{className:"item"},v.createElement("div",{className:"item-0"},"#",a+1," - ",C("program.".concat(e.type))),v.createElement("div",{className:"item-1 mt10"},C("sign.program_id"),v.createElement("span",null,(0,i.z)(e.programId))),v.createElement("div",{className:"item-1 mt15"},C("sign.data"),v.createElement("span",null,(0,i.z)(e.data))))))))))}]})})()),v.createElement("div",{className:"btn-box"},v.createElement("div",null,v.createElement(u.A,{className:"btn-cancel",onClick:()=>{b||H(void 0,i.a.userRejectedRequest())}},C("common.cancel")),v.createElement(u.A,{className:"btn-approve",onClick:V,loading:b},C("common.confirm"))),v.createElement(r.a,null)))}}}]);
//# sourceMappingURL=5744.0fe25063.chunk.js.map